{"version":3,"file":"AutoComplete.stories-be931be2.js","sources":["../../src/hooks/useClickOutside.ts","../../src/components/AutoComplete/AutoComplete.tsx"],"sourcesContent":["import { createRef, useEffect } from \"react\";\n\nexport default function useClickOutside(callback: (ev: Event) => void) {\n  const ref = createRef<HTMLDivElement>();\n  useEffect(() => {\n    function handleOutsideClick(ev: Event) {\n      if (ref.current && !ref.current.contains(ev.target as Node)) {\n        callback(ev);\n      }\n    }\n\n    document.addEventListener(\"mousedown\", handleOutsideClick);\n\n    return () => {\n      window.removeEventListener(\"mousedown\", handleOutsideClick);\n    };\n  }, [callback, ref]);\n\n  return ref;\n}\n","import { useMemo, useState } from \"react\";\nimport { Input } from \"../Input/Input\";\nimport scss from \"./AutoComplete.module.scss\";\nimport { Arrow } from \"../Icons/Arrow/Arrow\";\nimport { Close } from \"../Icons/Close/Close\";\nimport { Button } from \"../Button/Button\";\nimport { AutoCompleteProps, ListProps } from \"./AutoComplete.types\";\nimport useClickOutside from \"../../hooks/useClickOutside\";\n\nexport const AutoComplete = (props: AutoCompleteProps) => {\n  const [search, setSearch] = useState(\"\");\n  const [isOpen, setIsOpen] = useState(false);\n\n  const ref = useClickOutside(() => handleOpen(false));\n\n  function handleChange(ev: React.ChangeEvent<HTMLInputElement>) {\n    setSearch(ev.currentTarget.value);\n  }\n\n  function handleOpen(open?: boolean) {\n    setIsOpen((prev) => open ?? !prev);\n  }\n\n  function clearInput() {\n    setSearch(\"\");\n  }\n\n  function handleKeyDown(ev: React.KeyboardEvent<HTMLDivElement>) {\n    if (ev.key === \"Escape\") handleOpen();\n  }\n\n  function handleNavigateList(\n    ev: React.KeyboardEvent<HTMLLIElement>,\n    index: number\n  ) {\n    switch (ev.key) {\n      case \"ArrowDown\":\n        ev.preventDefault();\n        console.log(\"aaa\");\n        return document.querySelectorAll(\"button\")[index - 1]?.autofocus();\n        break;\n\n      case \"ArrowUp\":\n        ev.preventDefault();\n        return document.querySelectorAll(\"button\")[index + 1]?.focus();\n        break;\n      default:\n        break;\n    }\n  }\n\n  const filterList: ListProps[] = useMemo(() => {\n    const lowerSearch = search.toLowerCase();\n\n    return props.list.filter((list) =>\n      list.item.toLowerCase().includes(lowerSearch)\n    );\n  }, [props.list, search]);\n\n  const renderNotFoundList = () => (\n    <li data-open={isOpen} className={scss.item}>\n      {props.emptyMessage ?? `no search for ${search}`}\n    </li>\n  );\n\n  const renderList = () => (\n    <ul data-open={isOpen} aria-hidden={!isOpen} className={scss.list}>\n      {filterList.length > 0\n        ? filterList.map((list, index) => (\n            <li\n              // tabIndex={-1}\n              key={list.id}\n              data-open={isOpen}\n              className={scss.item}\n              onKeyDown={(ev) => handleNavigateList(ev, index)}\n            >\n              <button\n                className={scss.button}\n                onClick={() => {\n                  handleOpen();\n                  clearInput();\n                  setSearch(list.item);\n                  list.onSelect(list.item);\n                }}\n              >\n                {list.item}\n              </button>\n            </li>\n          ))\n        : renderNotFoundList()}\n    </ul>\n  );\n\n  return (\n    <div ref={ref} onKeyDown={handleKeyDown} className={scss.wrapper}>\n      <Input.Root>\n        <Input.Actions>\n          <Arrow variant outline orientation={`${isOpen ? \"down\" : \"up\"}`} />\n        </Input.Actions>\n        <Input.Input\n          fontSize={2.4}\n          spellCheck=\"false\"\n          onChange={handleChange}\n          value={search}\n          onClick={() => handleOpen()}\n          placeholder={props.placeholder}\n        />\n        <Input.Actions>\n          <Button variant=\"none\" onClick={clearInput}>\n            <Close variant />\n          </Button>\n        </Input.Actions>\n      </Input.Root>\n      {isOpen && renderList()}\n    </div>\n  );\n};\n"],"names":["useClickOutside","callback","ref","createRef","useEffect","handleOutsideClick","ev","AutoComplete","props","search","setSearch","useState","isOpen","setIsOpen","handleOpen","handleChange","open","prev","clearInput","handleKeyDown","handleNavigateList","index","_a","_b","filterList","useMemo","lowerSearch","list","renderNotFoundList","jsx","scss","renderList","jsxs","Input","Arrow","Button","Close"],"mappings":"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"}